---
title: "MSB1015 Scientific Programming: Assignment 2"
author: "Lian Laudy"
date: "5 oktober 2018"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Packages

Check if the required packages are already installed. If not, install them:
```{r}
packages = c("matrixStats", "Boruta", "pls", "ggplot2")
if (length(setdiff(packages, rownames(installed.packages()))) > 0) {
  install.packages(setdiff(packages, rownames(installed.packages())))  
}
```

Load the required packages:
```{r}
# the package 'matrixStats' is used to calculate the variance across each column (descriptor)
library(matrixStats)
# the package 'Boruta' is used to perform feature selection based on a Random Forest method
library(Boruta)
# the package 'pls' is used to perfrom the Partial Least Squares analysis
library(pls)
# the package 'ggplot2' is used to plot the observed and predicted activity scores
library(ggplot2)
```

# Load data

Load the data files.
The data file called 'score' has to contain the 'SID' in the first column and the Activity Score in the second column.
The data file called 'descriptors' has to contain the 'SID' in the first column and the descriptors in the remaining columns. 
```{r}
score = read.csv(file = 'C:/Users/Lian/Desktop/CloudStation/MSB1015 Scientific Programming/Assignments/2 Making multivariate statistics reproducible/qsarSmallData.csv', sep=',', row.names = 1, header=TRUE)

descriptors = read.csv(file = 'C:/Users/Lian/Desktop/CloudStation/MSB1015 Scientific Programming/Assignments/2 Making multivariate statistics reproducible/descriptors.csv', sep=',', row.names = 1, header=TRUE)
```
Sort both dataframes by substance ID such that the order of molecules matches:
```{r}
score = score[order(score$SID),]
row.names(score) = c(1:nrow(score))
descriptors =  descriptors[order(descriptors$molSIDs),]
row.names(descriptors) = c(1:nrow(descriptors))

#check if sorting went well:
table(score[,1] == descriptors[,1])
```
# Split data

Create a training set (80%) and a test set (20%):  
```{r}
# use set.seed() to ensure that the same random numbers are used and the results are reproducible
set.seed(0)
# selected 80% of the total number of rows
selection = sample(nrow(descriptors), 0.8*nrow(descriptors))
# use this selection to select the training data
score_tr = score[selection, ]
descs_tr = descriptors[selection, ]
# the same selection will be excluded from the test data
score_te = score[-selection, ]
descs_te = descriptors[-selection, ]
```
